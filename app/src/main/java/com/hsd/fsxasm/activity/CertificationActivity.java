package com.hsd.fsxasm.activity;import android.content.Intent;import android.view.View;import android.view.View.OnClickListener;import android.widget.AdapterView;import android.widget.AdapterView.OnItemSelectedListener;import android.widget.CompoundButton;import android.widget.CompoundButton.OnCheckedChangeListener;import android.widget.EditText;import android.widget.ImageView;import android.widget.LinearLayout;import android.widget.RadioButton;import android.widget.RelativeLayout;import android.widget.Spinner;import android.widget.TextView;import android.widget.Toast;import com.hsd.fsxasm.R;import com.hsd.fsxasm.adapter.SchoolAdapter;import com.hsd.fsxasm.base.BaseActivity;import com.hsd.fsxasm.domain.CertificationBean;import com.hsd.fsxasm.engine.NCertification;import com.hsd.fsxasm.engine.NCheckSchool;import com.hsd.fsxasm.utils.AsyncImageLoader;public class CertificationActivity extends BaseActivity{	private Spinner school;	private EditText number;	private EditText password;	private RelativeLayout check;		private SchoolAdapter adapter;	private EditText checkCode;	private ImageView checkImage;		private LinearLayout layout;	private String schoolName;		private RadioButton rb_button;	private TextView tv_xy;		@Override	protected void initData() {		// TODO Auto-generated method stub		mTitle.setText("实名认证");		school.setAdapter(adapter);	}	@Override	protected View initView() {		// TODO Auto-generated method stub		View parents = View.inflate(mActivity, R.layout.il_certification, null);		number = (EditText) parents.findViewById(R.id.it_number);		password = (EditText) parents.findViewById(R.id.it_password);		check = (RelativeLayout) parents.findViewById(R.id.gotocheck);		school = (Spinner) parents.findViewById(R.id.it_school);		layout = (LinearLayout) parents.findViewById(R.id.check_line);		checkCode = (EditText) parents.findViewById(R.id.it_checkcode);		checkImage = (ImageView) parents.findViewById(R.id.check_code_image);		rb_button = (RadioButton) parents.findViewById(R.id.rb_button);		tv_xy = (TextView) parents.findViewById(R.id.tv_xy);		adapter = new SchoolAdapter(mActivity);		rb_button.setChecked(true);		return parents;	}	private boolean temp = false;		@Override	protected void updataUI(Object obj) {		// TODO Auto-generated method stub		CertificationBean bean = (CertificationBean) obj;		String flag = bean.getVerificationCode();		System.out.println("是否有验证码呢" + flag);		if(flag==null){			if(!temp){				return ;			}						if(bean.getResultCode()==1){				Toast.makeText(mActivity, bean.getDescribe(), 0).show();				Intent intent = new Intent(mActivity,RegisterActivity.class);				intent.putExtra("student_number", number.getText().toString());				intent.putExtra("schoolText",schoolName);				startActivity(intent);				finish();			}else{				Toast.makeText(mActivity, bean.getDescribe(), 0).show();			}		}else{			String url = bean.getVerificationCode();			layout.setVisibility(View.VISIBLE);			AsyncImageLoader.getInstance().getImageLoaderInstance(mActivity).displayImage(url, checkImage);			temp = true;		}	}	@Override	protected void setListener() {		// TODO Auto-generated method stub		check.setOnClickListener(new OnClickListener() {						@Override			public void onClick(View v) {				// TODO Auto-generated method stub				temp = true;				NCertification nCertification = new NCertification(mActivity,new HttpResponseHandler());				nCertification.check(number.getText().toString(),password.getText().toString(),schoolName);			}		});				rb_button.setOnCheckedChangeListener(new OnCheckedChangeListener() {						@Override			public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {				// TODO Auto-generated method stub				if(isChecked){					check.setClickable(true);				}else{					check.setClickable(false);				}			}		});								school.setOnItemSelectedListener(new OnItemSelectedListener() {			@Override			public void onItemSelected(AdapterView<?> parent, View view,					int position, long id) {				// TODO Auto-generated method stu				schoolName = adapter.getSchools()[position];				temp = false;				layout.setVisibility(View.GONE);				if(position==0){					return;				}				System.out.println("学校名字" + schoolName);				NCheckSchool check = new NCheckSchool(mActivity, new HttpResponseHandler());				check.check(schoolName);							}			@Override			public void onNothingSelected(AdapterView<?> parent) {				// TODO Auto-generated method stub							}		});				tv_xy.setOnClickListener(new OnClickListener() {			@Override			public void onClick(View v) {				startActivity(new Intent(mActivity, xieyiActivity.class));			}		});	}}